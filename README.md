# AI Chat Assistant - æµè§ˆå™¨æ‰©å±•

ä¸€ä¸ªåŸºäº Vue 3 + TypeScript çš„æ™ºèƒ½èŠå¤©åŠ©æ‰‹æµè§ˆå™¨æ‰©å±•ï¼Œæ”¯æŒæ‚¬æµ®çª—å£å’Œä¾§è¾¹æ ä¸¤ç§æ˜¾ç¤ºæ¨¡å¼ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ¯ **æ™ºèƒ½å¯¹è¯**: AI é©±åŠ¨çš„èŠå¤©åŠ©æ‰‹ï¼ˆå½“å‰ä¸ºæ¨¡æ‹Ÿå›å¤ï¼Œå¯æ¥å…¥çœŸå® APIï¼‰
- ğŸ’¬ **ä¼šè¯ç®¡ç†**: åˆ›å»ºã€æŸ¥çœ‹ã€åˆ é™¤å¤šä¸ªå¯¹è¯ä¼šè¯
- ğŸ“ **æ¶ˆæ¯å†å²**: åŸºäº IndexedDB çš„æœ¬åœ°æŒä¹…åŒ–å­˜å‚¨
- ğŸ¨ **åŒæ˜¾ç¤ºæ¨¡å¼**: 
  - æ‚¬æµ®çª—å£ï¼ˆå¯æ‹–æ‹½ç§»åŠ¨ï¼‰
  - ä¾§è¾¹æ ï¼ˆå›ºå®šå³ä¾§ï¼‰

### UI ç‰¹æ€§
- ğŸ­ **ç°ä»£åŒ–è®¾è®¡**: æ¸å˜è‰²ã€åœ†è§’ã€é˜´å½±æ•ˆæœ
- ğŸ“Š **ç»Ÿè®¡ä¿¡æ¯**: å®æ—¶æ˜¾ç¤ºä¼šè¯æ•°å’Œæ¶ˆæ¯æ•°
- âš¡ **æµç•…åŠ¨ç”»**: æ¶ˆæ¯æ»‘å…¥ã€åŠ è½½åŠ¨ç”»ã€æ‚¬åœæ•ˆæœ
- ğŸ“± **å“åº”å¼å¸ƒå±€**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸

### æŠ€æœ¯ç‰¹æ€§
- ğŸš€ **æŒ‰éœ€æ³¨å…¥**: Content script æ‰‹åŠ¨æ³¨å…¥ï¼Œä¸å½±å“é¡µé¢æ€§èƒ½
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**: IndexedDB å­˜å‚¨ï¼Œæ”¯æŒç¦»çº¿è®¿é—®
- ğŸ”§ **å®Œæ•´é…ç½®**: API ç«¯ç‚¹ã€å¯†é’¥ã€æ¨¡å‹é€‰æ‹©
- ğŸ›ï¸ **è®¾ç½®ç®¡ç†**: ç‹¬ç«‹çš„ Options é¡µé¢

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Vue 3 (Composition API)
- **è¯­è¨€**: TypeScript
- **æ„å»ºå·¥å…·**: Vite 5
- **å­˜å‚¨**: IndexedDB
- **æ‰©å±• API**: Chrome Extension Manifest V3

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
ai-chat-extension/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ background/          # åå°æœåŠ¡
â”‚   â”‚   â””â”€â”€ index.ts         # æ¶ˆæ¯è·¯ç”±ã€æ•°æ®å¤„ç†
â”‚   â”œâ”€â”€ content/             # Content Script
â”‚   â”‚   â”œâ”€â”€ index.ts         # å…¥å£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatWindow.vue   # èŠå¤©çª—å£ç»„ä»¶
â”‚   â”‚   â””â”€â”€ style.css        # æ ·å¼
â”‚   â”œâ”€â”€ popup/               # Popup é¡µé¢
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ App.vue          # ä¸»ç•Œé¢
â”‚   â”œâ”€â”€ options/             # Options é¡µé¢
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ App.vue          # è®¾ç½®ç•Œé¢
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ db.ts            # IndexedDB å°è£…
â”‚   â”‚   â””â”€â”€ types.ts         # TypeScript ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ icons/               # å›¾æ ‡èµ„æº
â”œâ”€â”€ dist/                    # æ„å»ºè¾“å‡ºï¼ˆåŠ è½½æ­¤ç›®å½•åˆ° Chromeï¼‰
â”œâ”€â”€ manifest.json            # æ‰©å±•é…ç½®
â”œâ”€â”€ vite.config.ts           # Vite é…ç½®ï¼ˆå«è‡ªå®šä¹‰æ’ä»¶ï¼‰
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ ARCHITECTURE.md          # æ¶æ„è¯´æ˜æ–‡æ¡£
â””â”€â”€ TEST_GUIDE.md            # æµ‹è¯•æŒ‡å—

```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. æ„å»ºé¡¹ç›®

```bash
npm run build
```

æ„å»ºæˆåŠŸåï¼Œ`dist` ç›®å½•åŒ…å«æ‰€æœ‰æ‰©å±•æ–‡ä»¶ã€‚

### 3. åŠ è½½åˆ° Chrome

1. æ‰“å¼€ Chrome æµè§ˆå™¨
2. è®¿é—® `chrome://extensions/`
3. å¯ç”¨å³ä¸Šè§’çš„ **"å¼€å‘è€…æ¨¡å¼"**
4. ç‚¹å‡» **"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"**
5. é€‰æ‹©é¡¹ç›®çš„ `dist` ç›®å½•

### 4. å¼€å§‹ä½¿ç”¨

1. ç‚¹å‡»å·¥å…·æ ä¸­çš„æ‰©å±•å›¾æ ‡
2. åœ¨ Popup ä¸­ç‚¹å‡» **"æ‰“å¼€èŠå¤©çª—å£"**
3. åœ¨ä»»æ„ç½‘é¡µä¸Šå¼€å§‹å¯¹è¯ï¼

## ğŸ¯ æ ¸å¿ƒä»£ç ä½ç½®

| åŠŸèƒ½ | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|------|---------|------|
| èŠå¤©çª—å£ UI | `src/content/ChatWindow.vue` | å®Œæ•´çš„èŠå¤©ç•Œé¢å®ç° |
| Content Script å…¥å£ | `src/content/index.ts` | Vue åº”ç”¨æŒ‚è½½ã€æ¶ˆæ¯ç›‘å¬ |
| Popup ç•Œé¢ | `src/popup/App.vue` | ç»Ÿè®¡ä¿¡æ¯ã€å¿«æ·æ“ä½œ |
| Options ç•Œé¢ | `src/options/App.vue` | ä¼šè¯ç®¡ç†ã€è®¾ç½®é…ç½® |
| åå°æœåŠ¡ | `src/background/index.ts` | æ¶ˆæ¯è·¯ç”±ã€æ•°æ®å¤„ç† |
| æ•°æ®å­˜å‚¨ | `src/utils/db.ts` | IndexedDB å°è£… |
| æ„å»ºé…ç½® | `vite.config.ts` | è‡ªå®šä¹‰æ’ä»¶ã€æ‰“åŒ…é…ç½® |

## ğŸ”§ å…³é”®æŠ€æœ¯å®ç°

### 1. Content Script IIFE åŒ…è£…

Chrome æ‰©å±•çš„ content script ä¸æ”¯æŒ ES Moduleï¼Œéœ€è¦è½¬æ¢ä¸º IIFE æ ¼å¼ï¼š

```typescript
// vite.config.ts - inlineContentScript() æ’ä»¶
function inlineContentScript() {
  return {
    name: 'inline-content-script',
    enforce: 'post',
    generateBundle(options, bundle) {
      // æ”¶é›†æ‰€æœ‰ä¾èµ–
      // ç§»é™¤ import è¯­å¥
      // åŒ…è£…æˆ IIFE: (function(){ ...code... })()
    }
  }
}
```

### 2. æ‰‹åŠ¨æ³¨å…¥ Content Script

```typescript
// src/popup/App.vue
const toggleChat = async () => {
  try {
    // å°è¯•å‘é€æ¶ˆæ¯
    await chrome.tabs.sendMessage(tab.id, { type: 'TOGGLE_CHAT' })
  } catch (e) {
    // æœªæ³¨å…¥ï¼Œæ‰‹åŠ¨æ³¨å…¥
    await chrome.scripting.executeScript({
      target: { tabId: tab.id },
      files: ['content.js']
    })
    await chrome.scripting.insertCSS({
      target: { tabId: tab.id },
      files: ['content.css']
    })
    // é‡è¯•
    await chrome.tabs.sendMessage(tab.id, { type: 'TOGGLE_CHAT' })
  }
}
```

### 3. æ¶ˆæ¯é€šä¿¡æœºåˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Popup  â”‚ â”€sendMessageâ”€â”€â†’  â”‚ Background â”‚ â†â”€sendMessageâ”€â”€  â”‚   Content   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚                                â”‚
                                    â†“                                â†“
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ IndexedDBâ”‚                  â”‚ ChatWindow   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ (Vue ç»„ä»¶)   â”‚
                                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ å¼€å‘å‘½ä»¤

```bash
# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# éªŒè¯æ„å»ºäº§ç‰©
cd dist && ./verify.sh

# TypeScript ç±»å‹æ£€æŸ¥
npm run type-check
```

## ğŸ§ª æµ‹è¯•æ¸…å•

è¯¦ç»†æµ‹è¯•æ­¥éª¤è¯·æŸ¥çœ‹ [TEST_GUIDE.md](./TEST_GUIDE.md)

**å¿«é€Ÿæµ‹è¯•**ï¼š
- [ ] Popup é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] ç‚¹å‡»"æ‰“å¼€èŠå¤©çª—å£"æˆåŠŸ
- [ ] å‘é€æ¶ˆæ¯å¹¶æ”¶åˆ°å›å¤
- [ ] åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼ï¼ˆæ‚¬æµ®/ä¾§è¾¹æ ï¼‰
- [ ] Options é¡µé¢åŠŸèƒ½æ­£å¸¸
- [ ] åˆ·æ–°é¡µé¢åæ•°æ®ä¿æŒ

## ğŸ› å¸¸è§é—®é¢˜

### Q: Popup é¡µé¢ç©ºç™½ï¼Ÿ
**A**: æ£€æŸ¥ `dist/popup.html` æ˜¯å¦å­˜åœ¨ï¼Œè·¯å¾„å¼•ç”¨æ˜¯å¦æ­£ç¡®ï¼ˆ`./popup.js`ï¼‰

### Q: èŠå¤©çª—å£æ‰“ä¸å¼€ï¼Ÿ
**A**: 
1. æ£€æŸ¥ `dist/content.js` æ˜¯å¦ä¸º IIFE æ ¼å¼
2. æŸ¥çœ‹é¡µé¢ Console æ˜¯å¦æœ‰é”™è¯¯
3. ç¡®è®¤ manifest.json ä¸­ `web_accessible_resources` é…ç½®æ­£ç¡®

### Q: æ¶ˆæ¯å‘é€å¤±è´¥ï¼Ÿ
**A**: 
1. æ‰“å¼€ `chrome://extensions/` â†’ Service Worker æŸ¥çœ‹æ—¥å¿—
2. æ£€æŸ¥ IndexedDB æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ
3. ç¡®è®¤ background.js æ­£å¸¸è¿è¡Œ

### Q: è®¾ç½®æ— æ³•ä¿å­˜ï¼Ÿ
**A**: æ£€æŸ¥ background.js çš„æ¶ˆæ¯å¤„ç†é€»è¾‘ï¼Œç¡®è®¤ `SAVE_SETTING` æ¶ˆæ¯æ­£å¸¸å“åº”

## ğŸ”® ä¸‹ä¸€æ­¥å¼€å‘

- [ ] **æ¥å…¥çœŸå® AI API**: æ›¿æ¢ `simulateAIResponse()` å‡½æ•°
- [ ] **Markdown æ¸²æŸ“**: æ”¯æŒå¯Œæ–‡æœ¬æ¶ˆæ¯æ˜¾ç¤º
- [ ] **ä»£ç é«˜äº®**: ä»£ç å—è¯­æ³•é«˜äº®
- [ ] **æ¶ˆæ¯æ“ä½œ**: ç¼–è¾‘ã€åˆ é™¤ã€å¤åˆ¶æ¶ˆæ¯
- [ ] **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒå›¾ç‰‡ã€æ–‡æ¡£ä¸Šä¼ 
- [ ] **å¿«æ·é”®**: è‡ªå®šä¹‰é”®ç›˜å¿«æ·é”®
- [ ] **ä¸»é¢˜åˆ‡æ¢**: æ·±è‰²æ¨¡å¼æ”¯æŒ
- [ ] **å¯¼å‡ºåŠŸèƒ½**: å¯¼å‡ºå¯¹è¯å†å²
- [ ] **å¤šè¯­è¨€**: i18n å›½é™…åŒ–æ”¯æŒ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ARCHITECTURE.md](./ARCHITECTURE.md) - è¯¦ç»†æ¶æ„è¯´æ˜
- [TEST_GUIDE.md](./TEST_GUIDE.md) - å®Œæ•´æµ‹è¯•æŒ‡å—
- [Chrome Extension Docs](https://developer.chrome.com/docs/extensions/)
- [Vue 3 Documentation](https://vuejs.org/)
- [Vite Documentation](https://vitejs.dev/)

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**æ„å»ºçŠ¶æ€**: âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡  
**æœ€åæ›´æ–°**: 2026-01-24  
**ç‰ˆæœ¬**: 1.0.0
