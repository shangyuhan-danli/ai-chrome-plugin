var Ue=Object.defineProperty;var $e=(N,i,h)=>i in N?Ue(N,i,{enumerable:!0,configurable:!0,writable:!0,value:h}):N[i]=h;var re=(N,i,h)=>$e(N,typeof i!="symbol"?i+"":i,h);import{d as ze,f as He,m as M,o as l,c as r,b as t,t as w,g as m,w as $,n as z,p as ie,F as O,r as F,q as ce,h as ue,v as de,s as Re,l as g,u as V,_ as Ve,e as Ge}from"./chunks/_plugin-vue_export-helper-ByXR5g9Y.js";class Je{constructor(){re(this,"tools",new Map);this.registerBuiltinTools()}registerBuiltinTools(){this.register({name:"page_action",description:"åœ¨ç”¨æˆ·å½“å‰æµè§ˆçš„ç½‘é¡µä¸Šæ‰§è¡Œæ“ä½œï¼Œå¦‚å¡«å……è¾“å…¥æ¡†ã€ç‚¹å‡»æŒ‰é’®ã€é«˜äº®æ–‡å­—ç­‰ã€‚å¯ä»¥æ‰¹é‡æ‰§è¡Œå¤šä¸ªæ“ä½œã€‚",parameters:{type:"object",properties:{actions:{type:"array",description:"è¦æ‰§è¡Œçš„æ“ä½œåˆ—è¡¨",items:{type:"object",properties:{action:{type:"string",enum:["fill","click","highlight","underline","select","check","scroll","read"],description:"æ“ä½œç±»å‹: fill(å¡«å……è¾“å…¥æ¡†), click(ç‚¹å‡»), highlight(é«˜äº®), underline(ä¸‹åˆ’çº¿), select(é€‰æ‹©ä¸‹æ‹‰), check(å‹¾é€‰), scroll(æ»šåŠ¨), read(è¯»å–å†…å®¹)"},target:{type:"object",description:"ç›®æ ‡å…ƒç´ ",properties:{elementId:{type:"string",description:"å…ƒç´ ID (ä»é¡µé¢ä¸Šä¸‹æ–‡è·å–)"},selector:{type:"string",description:"CSSé€‰æ‹©å™¨ (å¤‡ç”¨)"},description:{type:"string",description:"å…ƒç´ æè¿° (ç”¨äºç¡®è®¤)"}}},params:{type:"object",description:"æ“ä½œå‚æ•°",properties:{value:{type:"string",description:"å¡«å……çš„å€¼æˆ–é€‰æ‹©çš„é€‰é¡¹"},color:{type:"string",description:"é«˜äº®é¢œè‰² (å¦‚ #ffeb3b)"},direction:{type:"string",enum:["up","down","top","bottom"],description:"æ»šåŠ¨æ–¹å‘"}}}},required:["action","target"]}}},required:["actions"]},execute:async(i,h)=>{const v=i.actions||[i],y=await chrome.tabs.sendMessage(h,{type:"EXECUTE_BATCH_ACTIONS",payload:v});return(y==null?void 0:y.data)||{success:!1,error:"æ‰§è¡Œå¤±è´¥"}}}),this.register({name:"request_more_elements",description:"å½“å‰é¡µé¢å…ƒç´ ä¿¡æ¯ä¸è¶³ä»¥å®Œæˆç”¨æˆ·è¯·æ±‚æ—¶ï¼Œè¯·æ±‚ç‰¹å®šåŒºåŸŸæˆ–ç±»å‹çš„æ›´å¤šå…ƒç´ ã€‚",parameters:{type:"object",properties:{region:{type:"string",enum:["form","header","sidebar","footer","below_viewport"],description:"é¡µé¢åŒºåŸŸ: form(è¡¨å•åŒºåŸŸ), header(é¡µå¤´), sidebar(ä¾§è¾¹æ ), footer(é¡µè„š), below_viewport(è§†å£ä¸‹æ–¹)"},elementType:{type:"string",enum:["input","button","link","select","all"],description:"å…ƒç´ ç±»å‹: input(è¾“å…¥æ¡†), button(æŒ‰é’®), link(é“¾æ¥), select(ä¸‹æ‹‰æ¡†), all(æ‰€æœ‰)"},keyword:{type:"string",description:"å…³é”®è¯ç­›é€‰ï¼ŒåŒ¹é…å…ƒç´ çš„æ–‡æœ¬ã€placeholderã€labelç­‰"}}},execute:async(i,h)=>{const v=await chrome.tabs.sendMessage(h,{type:"REQUEST_MORE_ELEMENTS",payload:i});return{success:!0,elements:(v==null?void 0:v.data)||[]}}}),this.register({name:"get_selected_text",description:"è·å–ç”¨æˆ·åœ¨é¡µé¢ä¸Šé€‰ä¸­çš„æ–‡å­—ï¼Œç”¨äºå¯¹é€‰ä¸­å†…å®¹è¿›è¡Œæ“ä½œã€‚",parameters:{type:"object",properties:{}},execute:async(i,h)=>{const v=await chrome.tabs.sendMessage(h,{type:"GET_SELECTED_TEXT"});return{success:!0,text:(v==null?void 0:v.data)||""}}}),this.register({name:"clear_ai_styles",description:"æ¸…é™¤ AI åœ¨é¡µé¢ä¸Šæ·»åŠ çš„æ‰€æœ‰é«˜äº®å’Œä¸‹åˆ’çº¿æ ·å¼ï¼Œæ¢å¤é¡µé¢åŸå§‹çŠ¶æ€ã€‚",parameters:{type:"object",properties:{}},execute:async(i,h)=>{const v=await chrome.tabs.sendMessage(h,{type:"CLEAR_AI_STYLES"});return{success:(v==null?void 0:v.success)||!1}}})}register(i){this.tools.set(i.name,i)}unregister(i){this.tools.delete(i)}isBrowserTool(i){return this.tools.has(i)}getToolNames(){return Array.from(this.tools.keys())}getToolDefinitions(){return Array.from(this.tools.values()).map(i=>({name:i.name,description:i.description,parameters:i.parameters}))}async execute(i,h){const v=this.tools.get(i);if(!v)return JSON.stringify({success:!1,error:`æœªçŸ¥çš„æµè§ˆå™¨å·¥å…·: ${i}`});try{const[y]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(y!=null&&y.id))return JSON.stringify({success:!1,error:"æ— æ³•è·å–å½“å‰æ ‡ç­¾é¡µ"});let a;try{a=JSON.parse(h)}catch{return JSON.stringify({success:!1,error:"æ— æ•ˆçš„å‚æ•°æ ¼å¼"})}const f=await v.execute(a,y.id);return JSON.stringify(f)}catch(y){return console.error(`æ‰§è¡Œå·¥å…· ${i} å¤±è´¥:`,y),JSON.stringify({success:!1,error:String(y)})}}}const G=new Je,qe={class:"chat-wrapper"},Fe={class:"chat-container"},Ke={class:"chat-header"},Xe={class:"header-left"},Qe={class:"header-title"},We={class:"header-badges"},Ye=["title"],Ze={key:1,class:"model-badge"},et={class:"header-right"},tt={key:0,class:"session-dropdown-menu"},st={class:"session-dropdown-header"},ot={class:"session-dropdown-list"},nt={key:0,class:"session-dropdown-loading"},at={key:1,class:"session-dropdown-empty"},lt=["onClick"],rt={class:"session-dropdown-info"},it={class:"session-dropdown-title"},ct={class:"session-dropdown-meta"},ut={key:0,class:"session-url"},dt={class:"session-time"},pt={key:0,class:"session-check"},vt={key:0,class:"empty-state"},gt={class:"message-box user-box"},kt={class:"message-time"},yt={class:"assistant-content"},ft={key:0,class:"think-block"},ht={class:"think-content"},mt={key:0,class:"message-box assistant-box"},wt={class:"block-content"},_t={key:1,class:"tool-block"},xt={class:"tool-header"},bt={class:"tool-name"},Ct={key:0,class:"tool-badge approved"},Tt={key:1,class:"tool-badge rejected"},St={class:"tool-params"},Mt={key:0,class:"tool-actions"},At=["onClick"],It=["onClick"],Et={class:"message-time"},Bt={key:1,class:"message assistant"},Nt={key:0,class:"token-stats-bar"},Dt={class:"token-stats-content"},jt={class:"token-stats-left"},Lt={class:"token-value"},Ot={class:"token-stats-detail"},Pt={class:"token-item"},Ut={class:"token-item-value prompt"},$t={class:"token-item"},zt={class:"token-item-value completion"},Ht={class:"token-progress-bar"},Rt={class:"chat-input-area"},Vt={key:0,class:"agent-selected-indicator"},Gt={key:0,class:"agent-dropdown-menu"},Jt={class:"agent-dropdown-header"},qt={class:"agent-dropdown-list"},Ft={key:0,class:"agent-dropdown-loading"},Kt={key:1,class:"agent-dropdown-empty"},Xt=["onClick"],Qt={class:"agent-dropdown-info"},Wt={class:"agent-dropdown-name"},Yt={key:0,class:"recommended-tag"},Zt={class:"agent-dropdown-desc"},es={key:0,class:"agent-check"},ts=["onKeydown"],ss=["disabled"],os=ze({__name:"App",setup(N){const i=g(),h=g(),v=g(""),y=g(!1),a=g([]),f=g(1),P=g(!1),pe=V(()=>{if(a.value.length===0)return!1;const s=a.value[a.value.length-1];return s.role!=="assistant"?!1:s.blocks.some(e=>e.type==="tool_use"&&e.status==="pending")}),U=g([]),_=g(null),D=g(!1),H=g(""),K=g(!1),R=g(null),J=g(""),q=g(""),X=g([]),j=g(!1),Q=g(!1),S=g({total:0,prompt:0,completion:0}),ve=V(()=>S.value.total===0?0:S.value.prompt/S.value.total*100),ge=V(()=>S.value.total===0?0:S.value.completion/S.value.total*100),W=s=>s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(1)+"K":s.toString(),B=g("gpt-3.5-turbo"),x=g(""),T=g(!1),ke=g(null),Y=V(()=>window.self!==window.top),ee=V(()=>{if(!H.value)return U.value;const s=H.value.toLowerCase();return U.value.filter(e=>{var o;return e.name.toLowerCase().includes(s)||e.description.toLowerCase().includes(s)||((o=e.tags)==null?void 0:o.some(n=>n.toLowerCase().includes(s)))})});He(async()=>{const s=new URLSearchParams(window.location.search),e=s.get("sessionId");e&&(f.value=parseInt(e));const o=s.get("pageUrl"),n=s.get("pageTitle");o&&(J.value=decodeURIComponent(o)),n&&(q.value=decodeURIComponent(n)),await se(),await te(),await ye(),M(()=>{var c;(c=h.value)==null||c.focus()}),window.addEventListener("message",c=>{c.data.type==="PIN_STATUS_CHANGED"&&(P.value=c.data.isPinned),c.data.type==="PAGE_INFO"&&(J.value=c.data.url,q.value=c.data.title,te())}),document.addEventListener("click",c=>{const p=c.target;p.closest(".agent-selector")||(D.value=!1),p.closest(".session-selector")||(j.value=!1)})});const te=async()=>{K.value=!0;try{const s=await chrome.runtime.sendMessage({type:"GET_AGENTS",payload:{userId:"default_user"}});if(s.success&&s.data){if(U.value=s.data.agents||[],R.value=s.data.recommended||null,R.value&&!_.value){const e=U.value.find(o=>o.id===R.value);e&&(_.value=e)}!_.value&&U.value.length>0&&(_.value=U.value[0])}}catch(s){console.error("åŠ è½½ Agent åˆ—è¡¨å¤±è´¥:",s)}finally{K.value=!1}},ye=async()=>{try{const s=await chrome.runtime.sendMessage({type:"GET_SETTING",payload:{key:"model"}});s!=null&&s.success&&s.data?B.value=s.data:B.value="gpt-3.5-turbo"}catch(s){console.error("åŠ è½½æ¨¡å‹è®¾ç½®å¤±è´¥:",s),B.value="gpt-3.5-turbo"}},fe=()=>{D.value=!D.value,D.value&&(H.value="")},he=s=>{_.value=s,D.value=!1},me=async()=>{j.value=!j.value,j.value&&await we()},we=async()=>{Q.value=!0;try{const s=await chrome.runtime.sendMessage({type:"GET_SESSIONS"});s.success&&(X.value=(s.data||[]).sort((e,o)=>o.updatedAt-e.updatedAt))}catch(s){console.error("åŠ è½½ä¼šè¯åˆ—è¡¨å¤±è´¥:",s)}finally{Q.value=!1}},_e=async s=>{f.value=s.id,j.value=!1,s.pageUrl&&(J.value=s.pageUrl),s.pageTitle&&(q.value=s.pageTitle),await se()},xe=s=>{try{return new URL(s).hostname}catch{return s}},be=s=>{const o=Date.now()-s,n=Math.floor(o/6e4),c=Math.floor(o/36e5),p=Math.floor(o/864e5);return n<1?"åˆšåˆš":n<60?`${n}åˆ†é’Ÿå‰`:c<24?`${c}å°æ—¶å‰`:p<7?`${p}å¤©å‰`:new Date(s).toLocaleDateString("zh-CN")},se=async()=>{const s=await chrome.runtime.sendMessage({type:"GET_MESSAGES",payload:{sessionId:f.value}});s.success&&(a.value=s.data.map(e=>({...e,blocks:e.blocks||[{type:"text",text:e.content}]})),M(I))},Ce=s=>s.blocks.filter(o=>o.type==="text").map(o=>o.text).join(""),Te=s=>JSON.stringify(s,null,2),Z=async(s="")=>{if(!Y.value)return null;try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(e!=null&&e.id))return null;const o=await chrome.tabs.sendMessage(e.id,{type:"GET_PAGE_CONTEXT",payload:{userMessage:s}});if(o!=null&&o.success)return ke.value=o.data,o.data}catch(e){console.error("è·å–é¡µé¢ä¸Šä¸‹æ–‡å¤±è´¥:",e)}return null},Se=async(s,e)=>await G.execute(s,e),Me=async(s,e,o)=>{var A;const n={sessionId:f.value,role:"user",blocks:[{type:"text",text:`[å·¥å…· ${s} æ‰§è¡Œç»“æœ]: ${o}`}],createdAt:Date.now()};a.value.push(n),M(I),T.value=!0,x.value="";const c={sessionId:f.value,role:"assistant",blocks:[{type:"text",text:""}],createdAt:Date.now()};a.value.push(c);const p=a.value.length-1;let b="",E=null;try{const d=await Z(),u=chrome.runtime.connect({name:"chat-stream"});u.onMessage.addListener(async C=>{if(C.type==="data"){const k=C.data;if(k.content){x.value+=k.content;const L=a.value[p].blocks.find(Pe=>Pe.type==="text");L&&L.type==="text"&&(L.text=x.value),M(I)}if(k.think&&k.think.reasoning_content&&(b=k.think.reasoning_content),k.toolCall&&k.toolCall.tool_name)try{E={type:"tool_use",id:`tool_${Date.now()}`,name:k.toolCall.tool_name,input:JSON.parse(k.toolCall.arguments||"{}"),status:"pending"}}catch(L){console.error("è§£æå·¥å…·å‚æ•°å¤±è´¥:",L)}k.statistic&&k.statistic.token_usage&&(S.value={total:k.statistic.token_usage.total_tokens||0,prompt:k.statistic.token_usage.prompt_tokens||0,completion:k.statistic.token_usage.completion_tokens||0})}else if(C.type==="done")T.value=!1,a.value[p].blocks=[],b&&(a.value[p].think=b),E?(a.value[p].blocks.push(E),a.value[p].isComplete=!1):(x.value&&a.value[p].blocks.push({type:"text",text:x.value}),a.value[p].isComplete=!0),u.disconnect(),M(I);else if(C.type==="error"){console.error("æµå¼å“åº”é”™è¯¯:",C.error);const k=a.value[p].blocks.find(L=>L.type==="text");k&&k.type==="text"&&(k.text=`é”™è¯¯: ${C.error}`),T.value=!1,u.disconnect()}}),u.postMessage({agentId:((A=_.value)==null?void 0:A.id)||"",sessionId:f.value,message:`æµè§ˆå™¨å·¥å…· ${s} æ‰§è¡Œç»“æœ: ${e}`,model:B.value,userId:"default_user",role:"user",currentPageInfo:d,browserTools:G.getToolDefinitions()})}catch(d){console.error("å‘é€å·¥å…·ç»“æœå¤±è´¥:",d),T.value=!1}},oe=async()=>{if(!v.value.trim()||y.value||T.value||pe.value)return;const s=v.value.trim();v.value="";const e={sessionId:f.value,role:"user",blocks:[{type:"text",text:s}],createdAt:Date.now()};a.value.push(e),M(I),_.value&&_.value.id?await Ae(s):await Ie(s)},Ae=async s=>{T.value=!0,x.value="";const e={sessionId:f.value,role:"assistant",blocks:[{type:"text",text:""}],createdAt:Date.now()};a.value.push(e);const o=a.value.length-1;let n="",c=null;try{const p=chrome.runtime.connect({name:"chat-stream"});p.onMessage.addListener(A=>{if(A.type==="data"){const d=A.data;if(d.content){x.value+=d.content;const u=a.value[o].blocks.find(C=>C.type==="text");u&&u.type==="text"&&(u.text=x.value),M(I)}if(d.think&&d.think.reasoning_content&&(n=d.think.reasoning_content),d.toolCall&&d.toolCall.tool_name)try{c={type:"tool_use",id:`tool_${Date.now()}`,name:d.toolCall.tool_name,input:JSON.parse(d.toolCall.arguments||"{}"),status:"pending"}}catch(u){console.error("è§£æå·¥å…·å‚æ•°å¤±è´¥:",u)}d.statistic&&d.statistic.token_usage&&(S.value={total:d.statistic.token_usage.total_tokens||0,prompt:d.statistic.token_usage.prompt_tokens||0,completion:d.statistic.token_usage.completion_tokens||0})}else if(A.type==="done")T.value=!1,a.value[o].blocks=[],n&&(a.value[o].think=n),c?(a.value[o].blocks.push(c),a.value[o].isComplete=!1):(!n&&x.value&&a.value[o].blocks.push({type:"text",text:x.value}),a.value[o].isComplete=!0),p.disconnect(),M(I);else if(A.type==="error"){console.error("æµå¼å“åº”é”™è¯¯:",A.error);const d=a.value[o].blocks.find(u=>u.type==="text");d&&d.type==="text"&&(d.text=`é”™è¯¯: ${A.error}`),T.value=!1,p.disconnect()}});const b=await Z(s),E=G.getToolDefinitions();p.postMessage({agentId:_.value.id,sessionId:f.value,message:s,model:B.value,userId:"default_user",role:"user",currentPageInfo:b,browserTools:E})}catch(p){console.error("å‘é€æµå¼æ¶ˆæ¯å¤±è´¥:",p);const b=a.value[o].blocks.find(E=>E.type==="text");b&&b.type==="text"&&(b.text=`å‘é€å¤±è´¥: ${p}`),T.value=!1}},Ie=async s=>{y.value=!0;try{const e=await chrome.runtime.sendMessage({type:"SEND_MESSAGE",payload:{sessionId:f.value,content:s}});if(e.success){const o={sessionId:f.value,role:"assistant",blocks:e.blocks||[{type:"text",text:e.response}],createdAt:Date.now(),isComplete:e.isComplete!==!1};a.value.push(o),M(I)}}catch(e){console.error("å‘é€æ¶ˆæ¯å¤±è´¥:",e)}finally{y.value=!1}},ne=async(s,e)=>{const o=a.value[a.value.length-1];let n;o&&o.role==="assistant"&&(n=o.blocks.find(c=>c.type==="tool_use"&&c.id===s),n&&(n.status=e?"approved":"rejected")),e&&(n&&G.isBrowserTool(n.name)?await Ee(n):await Be(s))},Ee=async s=>{const e=await Se(s.name,JSON.stringify(s.input));let o="";try{const n=JSON.parse(e);o=n.summary||n.message||(n.success?"æ‰§è¡ŒæˆåŠŸ":"æ‰§è¡Œå¤±è´¥")}catch{o=e}await Me(s.name,e,o)},Be=async s=>{var p;T.value=!0,x.value="";const e={sessionId:f.value,role:"assistant",blocks:[{type:"text",text:""}],createdAt:Date.now()};a.value.push(e);const o=a.value.length-1;let n="",c=null;try{const b=chrome.runtime.connect({name:"chat-stream"});b.onMessage.addListener(d=>{if(d.type==="data"){const u=d.data;if(u.content){x.value+=u.content;const C=a.value[o].blocks.find(k=>k.type==="text");C&&C.type==="text"&&(C.text=x.value),M(I)}if(u.think&&u.think.reasoning_content&&(n+=u.think.reasoning_content),u.toolCall&&u.toolCall.tool_name)try{c={type:"tool_use",id:`tool_${Date.now()}`,name:u.toolCall.tool_name,input:JSON.parse(u.toolCall.arguments||"{}"),status:"pending"}}catch(C){console.error("è§£æå·¥å…·å‚æ•°å¤±è´¥:",C)}u.statistic&&u.statistic.token_usage&&(S.value={total:u.statistic.token_usage.total_tokens||0,prompt:u.statistic.token_usage.prompt_tokens||0,completion:u.statistic.token_usage.completion_tokens||0})}else if(d.type==="done")T.value=!1,a.value[o].blocks=[],n&&(a.value[o].think=n),c?(a.value[o].blocks.push(c),a.value[o].isComplete=!1):(!n&&x.value&&a.value[o].blocks.push({type:"text",text:x.value}),a.value[o].isComplete=!0),b.disconnect(),M(I);else if(d.type==="error"){console.error("æµå¼å“åº”é”™è¯¯:",d.error);const u=a.value[o].blocks.find(C=>C.type==="text");u&&u.type==="text"&&(u.text=`é”™è¯¯: ${d.error}`),T.value=!1,b.disconnect()}});const E=await Z(),A=G.getToolDefinitions();b.postMessage({agentId:((p=_.value)==null?void 0:p.id)||"",sessionId:f.value,message:JSON.stringify({toolId:s,approved:!0}),model:B.value,userId:"default_user",role:"function",currentPageInfo:E,browserTools:A})}catch(b){console.error("å¤„ç†å·¥å…·å“åº”å¤±è´¥:",b),T.value=!1}},I=()=>{i.value&&(i.value.scrollTop=i.value.scrollHeight)},ae=s=>new Date(s).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),Ne=()=>{console.log("togglePin clicked, current isPinned:",P.value),window.parent&&window.parent!==window?(console.log("Sending PIN_CHAT message to parent"),window.parent.postMessage({type:"PIN_CHAT"},"*"),P.value=!P.value):console.log("Not in iframe, cannot pin")},De=()=>{window.parent&&window.parent!==window?window.parent.postMessage({type:"CLOSE_CHAT"},"*"):window.close()},je=()=>{const s=chrome.runtime.getURL(`chat.html?sessionId=${f.value}`);chrome.tabs.create({url:s}),window.parent&&window.parent.postMessage({type:"CLOSE_CHAT"},"*")},Le=()=>{chrome.tabs.create({url:"https://github.com/anthropics/claude-code/issues"})},Oe=()=>{const s=chrome.runtime.getURL("options.html");chrome.tabs.create({url:s})},le=async()=>{try{const s=J.value,e=q.value||"æ–°å¯¹è¯",o=await chrome.runtime.sendMessage({type:"CREATE_SESSION",payload:{title:e,pageUrl:s,pageTitle:e}});o.success&&(f.value=o.data.id,a.value=[],x.value="",T.value=!1,y.value=!1,M(()=>{var n;(n=h.value)==null||n.focus()}))}catch(s){console.error("åˆ›å»ºæ–°ä¼šè¯å¤±è´¥:",s)}};return(s,e)=>(l(),r("div",qe,[t("div",Fe,[t("div",Ke,[t("div",Xe,[e[4]||(e[4]=t("div",{class:"logo-icon"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),t("div",Qe,[e[3]||(e[3]=t("h3",null,"AI Chat Assistant",-1)),t("div",We,[_.value?(l(),r("span",{key:0,class:"agent-badge",title:_.value.name},w(_.value.name),9,Ye)):m("",!0),B.value?(l(),r("span",Ze,w(B.value),1)):m("",!0)])])]),t("div",et,[t("div",{class:"session-selector",onClick:$(me,["stop"])},[t("button",{class:z(["icon-btn",{active:j.value}]),title:"åˆ‡æ¢ä¼šè¯"},[...e[5]||(e[5]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],2),j.value?(l(),r("div",tt,[t("div",st,[e[7]||(e[7]=t("span",null,"å†å²ä¼šè¯",-1)),t("button",{class:"session-new-btn",onClick:$(le,["stop"])},[...e[6]||(e[6]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19","stroke-width":"2","stroke-linecap":"round"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12","stroke-width":"2","stroke-linecap":"round"})],-1),ie(" æ–°å»º ",-1)])])]),t("div",ot,[Q.value?(l(),r("div",nt,[...e[8]||(e[8]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"åŠ è½½ä¸­...",-1)])])):X.value.length===0?(l(),r("div",at," æš‚æ— å†å²ä¼šè¯ ")):(l(!0),r(O,{key:2},F(X.value,o=>(l(),r("div",{key:o.id,class:z(["session-dropdown-item",{selected:f.value===o.id}]),onClick:$(n=>_e(o),["stop"])},[t("div",rt,[t("div",it,w(o.title||o.pageTitle||"æœªå‘½åä¼šè¯"),1),t("div",ct,[o.pageUrl?(l(),r("span",ut,w(xe(o.pageUrl)),1)):m("",!0),t("span",dt,w(be(o.updatedAt)),1)])]),f.value===o.id?(l(),r("div",pt,[...e[9]||(e[9]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("polyline",{points:"20 6 9 17 4 12","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):m("",!0)],10,lt))),128))])])):m("",!0)]),t("button",{class:"icon-btn",onClick:le,title:"æ–°å»ºä¼šè¯"},[...e[10]||(e[10]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19","stroke-width":"2","stroke-linecap":"round"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12","stroke-width":"2","stroke-linecap":"round"})],-1)])]),t("button",{class:"icon-btn",onClick:Le,title:"å¸®åŠ©æ–‡æ¡£"},[...e[11]||(e[11]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("circle",{cx:"12",cy:"12",r:"10","stroke-width":"2"}),t("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),t("line",{x1:"12",y1:"17",x2:"12.01",y2:"17","stroke-width":"2","stroke-linecap":"round"})],-1)])]),t("button",{class:"icon-btn",onClick:Oe,title:"è®¾ç½®"},[...e[12]||(e[12]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("circle",{cx:"12",cy:"12",r:"3","stroke-width":"2"}),t("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),Y.value?(l(),r("button",{key:0,class:z(["icon-btn",{active:P.value}]),onClick:Ne,title:"å›ºå®šçª—å£"},[...e[13]||(e[13]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M16 4v8l3 3-2 2-3-3-4 4-2-2 4-4-3-3 2-2 3 3V4h2z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],2)):m("",!0),Y.value?(l(),r("button",{key:1,class:"icon-btn",onClick:je,title:"å…¨å±æ‰“å¼€"},[...e[14]||(e[14]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):m("",!0),t("button",{class:"icon-btn",onClick:De,title:"å…³é—­"},[...e[15]||(e[15]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18","stroke-width":"2","stroke-linecap":"round"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18","stroke-width":"2","stroke-linecap":"round"})],-1)])])])]),t("div",{class:"chat-messages",ref_key:"messagesContainer",ref:i},[a.value.length===0?(l(),r("div",vt,[...e[16]||(e[16]=[t("p",null,"å¼€å§‹å¯¹è¯å§",-1)])])):m("",!0),(l(!0),r(O,null,F(a.value,o=>(l(),r("div",{key:o.id||o.createdAt,class:z(["message",o.role,"message-in"])},[o.role==="user"?(l(),r(O,{key:0},[t("div",gt,w(Ce(o)),1),t("span",kt,w(ae(o.createdAt)),1)],64)):(l(),r(O,{key:1},[t("div",yt,[o.think?(l(),r("div",ft,[e[17]||(e[17]=t("div",{class:"think-header"},[t("span",{class:"think-icon"},"ğŸ’­"),t("span",{class:"think-label"},"æ€è€ƒè¿‡ç¨‹")],-1)),t("div",ht,w(o.think),1)])):m("",!0),(l(!0),r(O,null,F(o.blocks,(n,c)=>(l(),r(O,{key:c},[n.type==="text"?(l(),r("div",mt,[e[18]||(e[18]=t("span",{class:"block-indicator text-indicator"},"â–¶",-1)),t("span",wt,w(n.text),1)])):n.type==="tool_use"?(l(),r("div",_t,[t("div",xt,[e[19]||(e[19]=t("span",{class:"block-indicator tool-indicator"},"âš™",-1)),t("span",bt,w(n.name),1),n.status==="approved"?(l(),r("span",Ct,"å·²æ‰¹å‡†")):n.status==="rejected"?(l(),r("span",Tt,"å·²æ‹’ç»")):m("",!0)]),t("pre",St,w(Te(n.input)),1),n.status==="pending"&&!y.value?(l(),r("div",Mt,[t("button",{class:"btn btn-approve",onClick:p=>ne(n.id,!0)},"Approve",8,At),t("button",{class:"btn btn-reject",onClick:p=>ne(n.id,!1)},"Reject",8,It)])):m("",!0)])):m("",!0)],64))),128))]),t("span",Et,w(ae(o.createdAt)),1)],64))],2))),128)),y.value?(l(),r("div",Bt,[...e[20]||(e[20]=[t("div",{class:"assistant-content"},[t("div",{class:"message-box assistant-box typing"},[t("span"),t("span"),t("span")])],-1)])])):m("",!0)],512),S.value.total>0||T.value?(l(),r("div",Nt,[t("div",Dt,[t("div",jt,[e[21]||(e[21]=t("span",{class:"token-label"},"Token æ¶ˆè€—",-1)),t("span",Lt,w(W(S.value.total)),1)]),t("div",Ot,[t("div",Pt,[e[22]||(e[22]=t("span",{class:"token-item-label"},"è¾“å…¥",-1)),t("span",Ut,w(W(S.value.prompt)),1)]),t("div",$t,[e[23]||(e[23]=t("span",{class:"token-item-label"},"è¾“å‡º",-1)),t("span",zt,w(W(S.value.completion)),1)])])]),t("div",Ht,[t("div",{class:"token-progress-prompt",style:ce({width:ve.value+"%"})},null,4),t("div",{class:"token-progress-completion",style:ce({width:ge.value+"%"})},null,4)])])):m("",!0),t("div",Rt,[t("div",{class:"agent-selector",onClick:fe},[t("div",{class:z(["agent-selector-btn",{active:D.value}])},[e[24]||(e[24]=t("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"})],-1)),_.value?(l(),r("span",Vt)):m("",!0)],2),D.value?(l(),r("div",Gt,[t("div",Jt,[ue(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>H.value=o),placeholder:"æœç´¢ Agent...",onClick:e[1]||(e[1]=$(()=>{},["stop"]))},null,512),[[de,H.value]])]),t("div",qt,[K.value?(l(),r("div",Ft,[...e[25]||(e[25]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"åŠ è½½ä¸­...",-1)])])):ee.value.length===0?(l(),r("div",Kt," æš‚æ— å¯ç”¨ Agent ")):(l(!0),r(O,{key:2},F(ee.value,o=>{var n,c;return l(),r("div",{key:o.id,class:z(["agent-dropdown-item",{selected:((n=_.value)==null?void 0:n.id)===o.id,recommended:o.id===R.value}]),onClick:$(p=>he(o),["stop"])},[e[27]||(e[27]=t("div",{class:"agent-dropdown-avatar"},[t("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"})])],-1)),t("div",Qt,[t("div",Wt,[ie(w(o.name)+" ",1),o.id===R.value?(l(),r("span",Yt,"æ¨è")):m("",!0)]),t("div",Zt,w(o.description),1)]),((c=_.value)==null?void 0:c.id)===o.id?(l(),r("div",es,[...e[26]||(e[26]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("polyline",{points:"20 6 9 17 4 12","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):m("",!0)],10,Xt)}),128))])])):m("",!0)]),ue(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>v.value=o),onKeydown:Re($(oe,["exact","prevent"]),["enter"]),placeholder:"è¾“å…¥æ¶ˆæ¯... (Enterå‘é€)",rows:"1",ref_key:"inputArea",ref:h},null,40,ts),[[de,v.value]]),t("button",{class:"send-btn",onClick:oe,disabled:!v.value.trim()||y.value},[...e[28]||(e[28]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("line",{x1:"22",y1:"2",x2:"11",y2:"13","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),t("polygon",{points:"22 2 15 22 11 13 2 9 22 2","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],8,ss)])])]))}}),ns=Ve(os,[["__scopeId","data-v-2a2fc508"]]),as=Ge(ns);as.mount("#app");
