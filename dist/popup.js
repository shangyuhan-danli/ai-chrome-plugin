import{d as y,o as f,a as g,c as S,b as u,e as s,t as h,w as C,r as p,_ as x,f as M}from"./chunks/_plugin-vue_export-helper-C2GHlnqk.js";const E={class:"popup-container"},_={class:"content"},b={class:"stats-section"},I={class:"stat-item"},N={class:"stat-info"},z={class:"stat-value"},A={class:"stat-item"},B={class:"stat-info"},O={class:"stat-value"},T={class:"footer"},H=y({__name:"App",setup(j){const d=p(0),l=p(0);f(async()=>{w()});const w=async()=>{var o,t;try{const e=await chrome.runtime.sendMessage({type:"GET_SESSIONS"});e!=null&&e.success&&(d.value=((o=e.data)==null?void 0:o.length)||0);const i=(e==null?void 0:e.data)||[];let a=0;for(const r of i){const n=await chrome.runtime.sendMessage({type:"GET_MESSAGES",payload:{sessionId:r.id}});n!=null&&n.success&&(a+=((t=n.data)==null?void 0:t.length)||0)}l.value=a}catch(e){console.error("加载统计信息失败:",e)}},c=async()=>{var o;try{const t=await chrome.runtime.sendMessage({type:"GET_SESSIONS"});let e=1;if(t!=null&&t.success&&((o=t.data)==null?void 0:o.length)>0)e=t.data[0].id;else{const a=await chrome.runtime.sendMessage({type:"CREATE_SESSION",payload:{title:`新对话 ${new Date().toLocaleString("zh-CN")}`}});a!=null&&a.success&&(e=a.data.id)}const[i]=await chrome.tabs.query({active:!0,currentWindow:!0});if(i!=null&&i.id)try{await chrome.tabs.sendMessage(i.id,{type:"OPEN_CHAT",sessionId:e})}catch{console.log("Content script未注入，正在注入..."),await chrome.scripting.executeScript({target:{tabId:i.id},files:["content.js"]}),await chrome.scripting.insertCSS({target:{tabId:i.id},files:["content.css"]}),await new Promise(r=>setTimeout(r,100)),await chrome.tabs.sendMessage(i.id,{type:"OPEN_CHAT",sessionId:e})}window.close()}catch(t){console.error("打开聊天窗口失败:",t),alert("打开聊天窗口失败，请刷新页面后重试")}},k=async()=>{var o;try{const t=await chrome.runtime.sendMessage({type:"GET_SESSIONS"});let e=1;if(t!=null&&t.success&&((o=t.data)==null?void 0:o.length)>0)e=t.data[0].id;else{const a=await chrome.runtime.sendMessage({type:"CREATE_SESSION",payload:{title:`新对话 ${new Date().toLocaleString("zh-CN")}`}});a!=null&&a.success&&(e=a.data.id)}const i=chrome.runtime.getURL(`chat.html?sessionId=${e}`);await chrome.tabs.create({url:i}),window.close()}catch(t){console.error("全屏打开失败:",t),alert("全屏打开失败，请重试")}},v=()=>{chrome.runtime.openOptionsPage()},m=async()=>{try{const o=await chrome.runtime.sendMessage({type:"CREATE_SESSION",payload:{title:`新对话 ${new Date().toLocaleString("zh-CN")}`}});o!=null&&o.success&&await c()}catch(o){console.error("创建会话失败:",o)}};return(o,t)=>(g(),S("div",E,[t[11]||(t[11]=u('<div class="header" data-v-29463031><div class="header-content" data-v-29463031><div class="logo" data-v-29463031><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-29463031><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-29463031></path></svg></div><div class="header-text" data-v-29463031><h2 data-v-29463031>AI Chat Assistant</h2><p data-v-29463031>智能对话助手</p></div></div></div>',1)),s("div",_,[s("div",b,[s("div",I,[t[1]||(t[1]=s("div",{class:"stat-icon"},[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),s("div",N,[s("div",z,h(d.value),1),t[0]||(t[0]=s("div",{class:"stat-label"},"会话数",-1))])]),s("div",A,[t[3]||(t[3]=s("div",{class:"stat-icon"},[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),s("div",B,[s("div",O,h(l.value),1),t[2]||(t[2]=s("div",{class:"stat-label"},"消息数",-1))])])]),t[9]||(t[9]=s("div",{class:"divider"},null,-1)),s("div",{class:"actions-section"},[s("button",{class:"action-btn primary",onClick:c},[...t[4]||(t[4]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),s("span",null,"打开聊天窗口（内嵌）",-1)])]),s("button",{class:"action-btn secondary",onClick:k},[...t[5]||(t[5]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),s("span",null,"全屏打开",-1)])]),s("button",{class:"action-btn secondary",onClick:v},[...t[6]||(t[6]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("circle",{cx:"12",cy:"12",r:"3","stroke-width":"2"}),s("path",{d:"M12 1v6m0 6v6M1 12h6m6 0h6","stroke-width":"2","stroke-linecap":"round"})],-1),s("span",null,"设置与管理",-1)])]),s("button",{class:"action-btn secondary",onClick:m},[...t[7]||(t[7]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("line",{x1:"12",y1:"5",x2:"12",y2:"19","stroke-width":"2","stroke-linecap":"round"}),s("line",{x1:"5",y1:"12",x2:"19",y2:"12","stroke-width":"2","stroke-linecap":"round"})],-1),s("span",null,"新建会话",-1)])])]),t[10]||(t[10]=u('<div class="divider" data-v-29463031></div><div class="info-section" data-v-29463031><div class="info-item" data-v-29463031><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-29463031><circle cx="12" cy="12" r="10" stroke-width="2" data-v-29463031></circle><line x1="12" y1="16" x2="12" y2="12" stroke-width="2" stroke-linecap="round" data-v-29463031></line><line x1="12" y1="8" x2="12.01" y2="8" stroke-width="2" stroke-linecap="round" data-v-29463031></line></svg><div class="info-text" data-v-29463031><div class="info-title" data-v-29463031>使用提示</div><div class="info-desc" data-v-29463031>内嵌模式：固定在页面右侧<br data-v-29463031>全屏模式：在新标签页打开</div></div></div></div><div class="divider" data-v-29463031></div>',3)),s("div",T,[t[8]||(t[8]=s("div",{class:"version"},"v1.0.0",-1)),s("a",{href:"#",onClick:C(v,["prevent"]),class:"footer-link"},"帮助文档")])])]))}}),V=x(H,[["__scopeId","data-v-29463031"]]);M(V).mount("#app");
